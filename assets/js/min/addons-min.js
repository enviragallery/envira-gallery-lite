!function(a){a((function(){function n(n){a(n).attr("disabled")&&a(n).removeAttr("disabled"),a(n).parent().parent().hasClass("envira-addon-not-installed")&&a(n).text(envira_gallery_addons.install)}var e;a("form#add-on-search input#add-on-searchbox").on("keyup",(function(){clearTimeout(void 0);var n=a(this),e=a(n).val().toLowerCase(),i=a(n).data("heading"),t=a(n).data("results"),r=a(n).data("cancel");a("form#add-on-search .spinner").css("visibility","visible"),e.length<3?a("div.envira-addon").fadeIn("fast",(function(){a("form#add-on-search .spinner").css("visibility","hidden")})):(a("div.envira-addon").each((function(){a("h3.envira-addon-title",a(this)).text().toLowerCase().search(e)>=0?a(this).fadeIn():a(this).fadeOut()})),a("form#add-on-search .spinner").css("visibility","hidden"))})),a("#envira-filter-select").on("change",(function(){var n,e=a(this).val(),i=a("#envira-addons-unlicensed"),t=i.data("soliloquy-filter"),r=a("#envira-addons-unlicensed .envira-addon");switch(r.show(),e){case"asc":r.sort((function(n,e){return a(n).data("addon-title").localeCompare(a(e).data("addon-title"))})).each((function(n,e){a(e).removeClass("last"),i.append(e).hide().fadeIn(100)})),a("#envira-addons-unlicensed .envira-addon:nth-child(3n)").addClass("last");break;case"desc":r.sort((function(n,e){return a(e).data("addon-title").localeCompare(a(n).data("addon-title"))})).each((function(n,e){a(e).removeClass("last"),i.append(e).hide().fadeIn(100)})),a("#envira-addons-unlicensed .envira-addon:nth-child(3n)").addClass("last");break;case"sort-order":r.sort((function(n,e){return a(e).data("sort-order").toString().localeCompare(a(n).data("sort-order"))})).each((function(n,e){a(e).removeClass("last"),i.append(e).hide().fadeIn(100)})),a("#envira-addons-unlicensed .envira-addon:nth-child(3n)").addClass("last");break}})),a("#envira-addons").on("click.refreshInstallAddon",".envira-addon-action-button",(function(e){var i=a(this),t=a("#envira-addons").find(".envira-addon-action-button");a.each(t,(function(a,e){if(i==e)return!0;n(e)}))})),a("#envira-addons").on("click.activateAddon",".envira-activate-addon",(function(n){n.preventDefault();var e=a(this);a(".envira-addon-error").remove(),a(this).html('<i class="envira-toggle-on"></i> '+envira_gallery_addons.activating),a(this).next().css({display:"inline-block","margin-top":"0px"});var i=a(this),t=a(this).attr("rel"),r=a(this).parent().parent(),d=a(this).parent().parent().find(".addon-status"),s={url:ajaxurl,type:"post",async:!0,cache:!1,dataType:"json",data:{action:"envira_gallery_activate_addon",nonce:envira_gallery_addons.activate_nonce,plugin:t},success:function(n){if(n&&!0!==n)a(r).slideDown("normal",(function(){a(this).after('<div class="envira-addon-error"><strong>'+n.error+"</strong></div>"),e.next().hide(),a(".envira-addon-error").delay(3e3).slideUp()}));else{a(i).html('<i class="envira-toggle-on"></i> '+envira_gallery_addons.deactivate).removeClass("envira-activate-addon").addClass("envira-deactivate-addon"),a(d).text(envira_gallery_addons.active);var t=a(d),s,o,l;o=(s=t.html().split(/\s+/)).pop(),l=s.join(" "),t.html([l," <span>",o,"</span>"].join("")),a(r).removeClass("envira-addon-inactive").addClass("envira-addon-active"),e.next().hide()}},error:function(a,n,i){e.next().hide()}};a.ajax(s)})),a("#envira-addons").on("click.deactivateAddon",".envira-deactivate-addon",(function(n){n.preventDefault();var e=a(this);a(".envira-addon-error").remove(),a(this).html('<i class="envira-toggle-on"></i> '+envira_gallery_addons.deactivating),a(this).next().css({display:"inline-block","margin-top":"0px"});var i=a(this),t=a(this).attr("rel"),r=a(this).parent().parent(),d=a(this).parent().parent().find(".addon-status"),s={url:ajaxurl,type:"post",async:!0,cache:!1,dataType:"json",data:{action:"envira_gallery_deactivate_addon",nonce:envira_gallery_addons.deactivate_nonce,plugin:t},success:function(n){if(n&&!0!==n)a(r).slideDown("normal",(function(){a(this).after('<div class="envira-addon-error"><strong>'+n.error+"</strong></div>"),e.next().hide(),a(".envira-addon-error").delay(3e3).slideUp()}));else{a(i).html('<i class="envira-toggle-on"></i> '+envira_gallery_addons.activate).removeClass("envira-deactivate-addon").addClass("envira-activate-addon"),a(d).text(envira_gallery_addons.inactive);var t=a(d),s,o,l;o=(s=t.html().split(/\s+/)).pop(),l=s.join(" "),t.html([l," <span>",o,"</span>"].join("")),a(r).removeClass("envira-addon-active").addClass("envira-addon-inactive"),e.next().hide()}},error:function(a,n,i){e.next().hide()}};a.ajax(s)})),a("#envira-addons").on("click.installAddon",".envira-install-addon",(function(n){n.preventDefault();var e=a(this);a(".envira-addon-error").remove(),a(this).html('<i class="envira-cloud-download"></i> '+envira_gallery_addons.installing),a(this).next().css({display:"inline-block","margin-top":"0px"});var i=a(this),t=a(this).attr("rel"),r=a(this).parent().parent(),d=a(this).parent().parent().find(".addon-status"),s={url:ajaxurl,type:"post",async:!0,cache:!1,dataType:"json",data:{action:"envira_gallery_install_addon",nonce:envira_gallery_addons.install_nonce,plugin:t},success:function(n){if(n.error)a(r).slideDown("normal",(function(){a(i).parent().parent().after('<div class="envira-addon-error"><div class="xinterior"><p><strong>'+n.error+"</strong></p></div></div>"),a(i).html('<i class="envira-cloud-download"></i> '+envira_gallery_addons.install),e.next().hide(),a(".envira-addon-error").delay(4e3).slideUp()}));else{if(n.form)return a(r).slideDown("normal",(function(){a(this).after('<div class="envira-addon-error">'+n.form+"</div>"),e.next().hide()})),a(i).attr("disabled",!0),void a("#envira-addons").on("click.installCredsAddon","#upgrade",(function(n){n.preventDefault(),e.next().hide(),a(this).html('<i class="envira-cloud-download"></i> '+envira_gallery_addons.installing),a(this).next().css({display:"inline-block","margin-top":"0px"});var s=a(this).parent().parent().find("#hostname").val(),o=a(this).parent().parent().find("#username").val(),l=a(this).parent().parent().find("#password").val(),v=a(this),c=a(this).parent().parent().parent().parent(),p={url:ajaxurl,type:"post",async:!0,cache:!1,dataType:"json",data:{action:"envira_gallery_install_addon",nonce:envira_gallery_addons.install_nonce,plugin:t,hostname:s,username:o,password:l},success:function(n){if(n.error)a(r).slideDown("normal",(function(){a(i).parent().parent().after('<div class="envira-addon-error"><strong>'+n.error+"</strong></div>"),a(i).html('<i class="envira-cloud-download"></i> '+envira_gallery_addons.install),e.next().hide(),a(".envira-addon-error").delay(4e3).slideUp()}));else{if(n.form)return e.next().hide(),a(".envira-inline-error").remove(),a(v).val(envira_gallery_addons.proceed),void a(v).after('<span class="envira-inline-error">'+envira_gallery_addons.connect_error+"</span>");a(c).remove(),a(i).show(),a(i).text(envira_gallery_addons.activate).removeClass("envira-install-addon").addClass("envira-activate-addon"),a(i).attr("rel",n.plugin),a(i).removeAttr("disabled"),a(d).text(envira_gallery_addons.inactive);var t=a(d),s,o,l;o=(s=t.html().split(/\s+/)).pop(),l=s.join(" "),t.html([l," <span>",o,"</span>"].join("")),a(r).removeClass("envira-addon-not-installed").addClass("envira-addon-inactive"),e.next().hide()}},error:function(a,n,i){e.next().hide()}};a.ajax(p)}));a(i).html('<i class="envira-toggle-on"></i> '+envira_gallery_addons.activate).removeClass("envira-install-addon").addClass("envira-activate-addon"),a(i).attr("rel",n.plugin),a(d).text(envira_gallery_addons.inactive);var s=a(d),o,l,v;l=(o=s.html().split(/\s+/)).pop(),v=o.join(" "),s.html([v," <span>",l,"</span>"].join("")),a(r).removeClass("envira-addon-not-installed").addClass("envira-addon-inactive"),e.next().hide()}},error:function(a,n,i){e.next().hide()}};a.ajax(s)}))}))}(jQuery);